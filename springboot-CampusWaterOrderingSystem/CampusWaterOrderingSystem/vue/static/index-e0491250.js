import{af as e,b as a,a as l,r as t,w as o,f as r,ag as u,h as d,X as c,k as p,j as n,i,o as s,m,ah as g,A as f,ai as h,z as v,aj as _,ak as b,al as y,E as V,am as P,_ as S}from"./index-2dac3e0d.js";import{u as k}from"./usePagination-526c8b6d.js";const C={class:"app-container"},I={class:"toolbar-wrapper"},z={class:"table-wrapper"},N={class:"pager-wrapper"},D=S(a({name:"products",__name:"index",setup(a){const S=l(!1),{paginationData:D,handleCurrentChange:w,handleSizeChange:x}=k(),U=l(!1),T=l(null),j=t({categoryId:0,imageId:0,productDescription:"",productDetails:"",productName:"",productPrice:0,productStatus:"",productStock:0}),B=t({categoryId:[{required:!0,trigger:"blur",message:"请输入种类id"}],imageId:[{required:!0,trigger:"blur",message:"请输入图片ID"}]}),E=()=>{var a;null==(a=T.value)||a.validate((a=>{if(!a)return!1;var l;void 0===L.value?(l=j,e({url:"product/addProducts",method:"POST",params:l})).then((e=>{V.success("新增成功"),U.value=!1,X()})):function(a){return e({url:"product/modProducts",method:"POST",params:a})}({productId:L.value,...j}).then((e=>{V.success("修改成功"),U.value=!1,X()}))}))},O=()=>{L.value=void 0,j.categoryId=0,j.imageId=0,j.productDescription="",j.productDetails="",j.productName="",j.productPrice=0,j.productStatus="",j.productStock=0},R=a=>{P.confirm(`正在删除用户：${a.productName}，确认删除？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{var l;(l={productId:a.productId},e({url:"product/deleteProducts",method:"DELETE",params:l})).then((e=>{V.success("删除成功"),X()}))}))},L=l(void 0),q=t([]),A=l(null),F=t({productName:""}),X=()=>{var a,l,t;S.value=!0,0!==F.productName.length?(l={pageNum:D.currentPage,pageSize:D.pageSize},t={productName:F.productName},e({url:"product/selectProductByProductName",method:"POST",data:{...l,param:t}})).then((e=>{q.length=0,D.total=e.data.totalRecords,q.push(...e.data.productList)})).catch((e=>{q.length=0})).finally((()=>{S.value=!1})):(a={pageSize:D.pageSize,pageNum:D.currentPage},e({url:"product/getAllProducts",method:"POST",data:a})).then((e=>{q.length=0,D.total=e.data.totalRecords,q.push(...e.data.productList)})).catch((e=>{q.length=0})).finally((()=>{S.value=!1}))},$=()=>{1===D.currentPage&&X(),D.currentPage=1},G=()=>{var e;null==(e=A.value)||e.resetFields(),1===D.currentPage&&X(),D.currentPage=1},H=()=>{X()};return o([()=>D.currentPage,()=>D.pageSize],X,{immediate:!0}),(e,a)=>{const l=r("el-input"),t=r("el-form-item"),o=r("el-button"),V=r("el-form"),k=r("el-card"),X=r("el-tooltip"),J=r("el-table-column"),K=r("el-table"),M=r("el-pagination"),Q=r("el-input-number"),W=r("el-dialog"),Y=u("loading");return s(),d("div",C,[c((s(),p(k,{shadow:"never",class:"search-wrapper"},{default:n((()=>[i(V,{ref_key:"searchFormRef",ref:A,inline:!0,model:F},{default:n((()=>[i(t,{prop:"productName",label:"商品名"},{default:n((()=>[i(l,{modelValue:F.productName,"onUpdate:modelValue":a[0]||(a[0]=e=>F.productName=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1}),i(t,null,{default:n((()=>[i(o,{type:"primary",icon:m(g),onClick:$},{default:n((()=>[f("查询")])),_:1},8,["icon"]),i(o,{icon:m(h),onClick:G},{default:n((()=>[f("重置")])),_:1},8,["icon"])])),_:1})])),_:1},8,["model"])])),_:1})),[[Y,S.value]]),c((s(),p(k,{shadow:"never"},{default:n((()=>[v("div",I,[v("div",null,[i(o,{type:"primary",icon:m(_),onClick:a[1]||(a[1]=e=>U.value=!0)},{default:n((()=>[f("新增商品")])),_:1},8,["icon"])]),v("div",null,[i(X,{content:"下载"},{default:n((()=>[i(o,{type:"primary",icon:m(b),circle:""},null,8,["icon"])])),_:1}),i(X,{content:"刷新表格"},{default:n((()=>[i(o,{type:"primary",icon:m(y),circle:"",onClick:H},null,8,["icon"])])),_:1})])]),v("div",z,[i(K,{data:q},{default:n((()=>[i(J,{type:"selection",width:"50",align:"center"}),i(J,{prop:"productId",label:"id",align:"center"}),i(J,{prop:"productName",label:"商品名",align:"center"}),i(J,{prop:"productDescription",label:"商品描述",align:"center"}),i(J,{prop:"productPrice",label:"商品价格",align:"center"}),i(J,{prop:"productStock",label:"商品库存",align:"center"}),i(J,{prop:"productStatus",label:"商品状态",align:"center"}),i(J,{prop:"productDetails",label:"商品详情",align:"center"},{default:n((e=>[i(o,{type:"primary",text:"",bg:"",size:"small",onClick:a=>{return l=e.row.productDetails,void P.alert(l,"商品详情",{confirmButtonText:"关闭"});var l}},{default:n((()=>[f("展示详情")])),_:2},1032,["onClick"])])),_:1}),i(J,{fixed:"right",label:"操作",width:"150",align:"center"},{default:n((e=>[i(o,{type:"primary",text:"",bg:"",size:"small",onClick:a=>{return l=e.row,L.value=l.categoryId,void(U.value=!0);var l}},{default:n((()=>[f("修改")])),_:2},1032,["onClick"]),i(o,{type:"danger",text:"",bg:"",size:"small",onClick:a=>R(e.row)},{default:n((()=>[f("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])]),v("div",N,[i(M,{background:"",layout:m(D).layout,"page-sizes":m(D).pageSizes,total:m(D).total,"page-size":m(D).pageSize,currentPage:m(D).currentPage,onSizeChange:m(x),onCurrentChange:m(w)},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])])),_:1})),[[Y,S.value]]),i(W,{modelValue:U.value,"onUpdate:modelValue":a[11]||(a[11]=e=>U.value=e),title:void 0===L.value?"新增商品":"修改商品",onClose:O,width:"30%"},{footer:n((()=>[i(o,{onClick:a[10]||(a[10]=e=>U.value=!1)},{default:n((()=>[f("取消")])),_:1}),i(o,{type:"primary",onClick:E},{default:n((()=>[f("确认")])),_:1})])),default:n((()=>[i(V,{ref_key:"formRef",ref:T,model:j,rules:B,"label-width":"100px","label-position":"left"},{default:n((()=>[i(t,{prop:"categoryId",label:"分类id"},{default:n((()=>[i(Q,{modelValue:j.categoryId,"onUpdate:modelValue":a[2]||(a[2]=e=>j.categoryId=e),min:0},null,8,["modelValue"])])),_:1}),i(t,{prop:"imageId",label:"图片id"},{default:n((()=>[i(Q,{modelValue:j.imageId,"onUpdate:modelValue":a[3]||(a[3]=e=>j.imageId=e),min:0},null,8,["modelValue"])])),_:1}),i(t,{prop:"productName",label:"产品名称"},{default:n((()=>[i(l,{modelValue:j.productName,"onUpdate:modelValue":a[4]||(a[4]=e=>j.productName=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1}),i(t,{prop:"productDescription",label:"商品描述"},{default:n((()=>[i(l,{modelValue:j.productDescription,"onUpdate:modelValue":a[5]||(a[5]=e=>j.productDescription=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1}),i(t,{prop:"productPrice",label:"商品价格"},{default:n((()=>[i(Q,{modelValue:j.productPrice,"onUpdate:modelValue":a[6]||(a[6]=e=>j.productPrice=e),precision:2,min:0},null,8,["modelValue"])])),_:1}),i(t,{prop:"productStock",label:"商品库存"},{default:n((()=>[i(Q,{modelValue:j.productStock,"onUpdate:modelValue":a[7]||(a[7]=e=>j.productStock=e),min:0},null,8,["modelValue"])])),_:1}),i(t,{prop:"productStatus",label:"商品状态"},{default:n((()=>[i(l,{modelValue:j.productStatus,"onUpdate:modelValue":a[8]||(a[8]=e=>j.productStatus=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1}),i(t,{prop:"productDetails",label:"商品细节"},{default:n((()=>[i(l,{modelValue:j.productDetails,"onUpdate:modelValue":a[9]||(a[9]=e=>j.productDetails=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-ab7ff8a2"]]);export{D as default};
